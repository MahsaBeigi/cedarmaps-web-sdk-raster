<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <title>CedarMaps - Simple Map Load</title>

    <script src='../dist/v1.8.0/cedarmaps.uncompressed.js'></script>
    <script src='../access-token.js'></script>
    <script src='./js/leaflet-omnivore.min.js'></script>

    <link href='../dist/v1.8.0/cedarmaps.css' rel='stylesheet' />


    <!-- In this demo we've intentioanlly used the standalone version of SDK along with leaflet source.
        To have the packed and minified version please see other demo files in this folder -->
    <script src='./js/leaflet-src.js'></script>
    <script src='./js/leaflet.contextmenu.js'></script>
    <script src='../dist/v1.8.0/cedarmaps.standalone.uncompressed.js'></script>
    <script src='../access-token.js'></script>
    <link href='../dist/v1.8.0/cedarmaps.css' rel='stylesheet' />
    <link href='./css/leaflet-contextmenu.css' rel='stylesheet' />
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        .map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>

<body>
    <div id='map' class='map'> </div>
    <script>
        try {
            L.cedarmaps.accessToken = accessToken;
        } catch (err) {
            throw new Error('You need to get an access token to be able to use cedarmaps SDK. ' +
                'Send us an email to <info@cedar.ir>');
        }

        /**
         * Initilizing Map View
         */

        // Getting maps info from a tileJSON source
        var tileJSONUrl = 'https://api.cedarmaps.com/v1/tiles/cedarmaps.streets.json?access_token=' + L.cedarmaps.accessToken;

        // initilizing map into div#map
        // and also activating a context menu for our maps
        var map = L.cedarmaps.map('map', tileJSONUrl, {
            scrollWheelZoom: true,
            zoomControl: false,
            minZoom: 7,
            maxZoom: 17,
            maxBounds: [[25.064, 44.039],[39.771, 63.322]],  // Iran's bounding box
            contextmenu: true,
            contextmenuWidth: 230,
            locateControl: true,
            contextmenuItems: [
                {
                    text: 'موقعیت نقشه',
                    callback: function(latlngObj, layerPoint, containerPoint) {
                        alert('You have clicked on: '+ latlngObj.latlng);
                    }.bind(this)
                }
            ]
        }).setView([35.757448286487595, 51.40876293182373], 7);

        /**
         * Drawing our KML data
         */
        
        // We draw a sample route to map using a test kml file.
        // We use leaflet-omnivore plugin for parsing this format: https://github.com/mapbox/leaflet-omnivore
        var customLayer = L.geoJson(null, {
            
            // http://leafletjs.com/reference.html#geojson-style
            style: function(feature) {
                return { color: '#f00' };
            }
        });

        var runLayer = omnivore.kml('./data/test-route.kml', null, customLayer)
            .on('ready', function() {
                map.fitBounds(runLayer.getBounds());
            })
            .addTo(map);
    </script>
</body>

</html>